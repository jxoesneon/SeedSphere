Running build hooks...Running build hooks...00:00 [32m+0[0m: [1m[90mloading test/rate_limit_middleware_test.dart[0m[0m                                                                                                                                                 00:00 [32m+0[0m: test/rate_limit_middleware_test.dart: RateLimitMiddleware allows requests under limit[0m                                                                                                        00:00 [32m+1[0m: test/rate_limit_middleware_test.dart: RateLimitMiddleware allows requests under limit[0m                                                                                                        00:00 [32m+1[0m: test/rate_limit_middleware_test.dart: RateLimitMiddleware blocks requests over limit[0m                                                                                                         00:00 [32m+2[0m: test/rate_limit_middleware_test.dart: RateLimitMiddleware blocks requests over limit[0m                                                                                                         00:00 [32m+2[0m: test/rate_limit_middleware_test.dart: RateLimitMiddleware heartbeat has higher limit[0m                                                                                                         00:00 [32m+3[0m: test/rate_limit_middleware_test.dart: RateLimitMiddleware heartbeat has higher limit[0m                                                                                                         00:00 [32m+3[0m: [1m[90mloading test/addon_service_test.dart[0m[0m                                                                                                                                                         00:00 [32m+3[0m: test/addon_service_test.dart: AddonService Manifest returns valid JSON[0m                                                                                                                       00:00 [32m+4[0m: test/tracker_service_test.dart: TrackerService getBestTrackers returns list from db[0m                                                                                                          00:00 [32m+5[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should parse full metadata stack (4K HDR Atmos)[0m                                                                                        00:00 [32m+6[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should parse full metadata stack (4K HDR Atmos)[0m                                                                                        00:00 [32m+7[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should parse full metadata stack (4K HDR Atmos)[0m                                                                                        00:00 [32m+8[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should parse full metadata stack (4K HDR Atmos)[0m                                                                                        00:00 [32m+8[0m: test/addon_service_test.dart: AddonService Catalog fallback on error[0m                                                                                                                         
Cinemeta Proxy Error: Exception: Network Error
00:00 [32m+9[0m: test/tracker_service_test.dart: TrackerService optimize filters unsafe localhost/private IPs and returns filtered list[0m                                                                       00:00 [32m+10[0m: test/tracker_service_test.dart: TrackerService optimize filters unsafe localhost/private IPs and returns filtered list[0m                                                                      00:00 [32m+11[0m: test/tracker_service_test.dart: TrackerService optimize filters unsafe localhost/private IPs and returns filtered list[0m                                                                      00:00 [32m+12[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should detect languages[0m                                                                                                               00:00 [32m+13[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should detect languages[0m                                                                                                               00:00 [32m+14[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should detect languages[0m                                                                                                               00:00 [32m+14[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should detect size from title if missing in fields[0m                                                                                    00:00 [32m+15[0m: test/metadata_parity_test.dart: Metadata Parity Tests Should detect size from title if missing in fields[0m                                                                                    00:00 [32m+15[0m: [1m[90mloading test/pairing_service_test.dart[0m[0m                                                                                                                                                      00:00 [32m+15[0m: test/pairing_service_test.dart: PairingService Full Pairing Flow[0m                                                                                                                            00:00 [32m+16[0m: test/health_service_test.dart: HealthService checkHealthy HTTP success (HEAD)[0m                                                                                                               00:00 [32m+17[0m: test/health_service_test.dart: HealthService checkHealthy HTTP success (HEAD)[0m                                                                                                               00:01 [32m+17[0m: test/health_service_test.dart: HealthService checkHealthy HTTP success (HEAD)[0m                                                                                                               00:01 [32m+18[0m: test/health_service_test.dart: HealthService checkHealthy HTTP success (HEAD)[0m                                                                                                               00:01 [32m+18[0m: test/health_service_test.dart: HealthService checkHealthy HTTP fallback to GET[0m                                                                                                              00:01 [32m+19[0m: test/health_service_test.dart: HealthService checkHealthy HTTP fallback to GET[0m                                                                                                              00:01 [32m+19[0m: test/health_service_test.dart: HealthService checkHealthy HTTP fails on 404/500[0m                                                                                                             00:01 [32m+20[0m: test/health_service_test.dart: HealthService checkHealthy HTTP fails on 404/500[0m                                                                                                             00:01 [32m+20[0m: test/health_service_test.dart: HealthService checkHealthy uses cache[0m                                                                                                                        00:01 [32m+21[0m: test/ai_service_test.dart: AiCache should store and retrieve values[0m                                                                                                                         00:01 [32m+22[0m: test/ai_service_test.dart: AiCache should store and retrieve values[0m                                                                                                                         00:01 [32m+23[0m: test/event_service_test.dart: EventService Subscribe receives initial connected event[0m                                                                                                       00:01 [32m+24[0m: test/event_service_test.dart: EventService Subscribe receives initial connected event[0m                                                                                                       00:01 [32m+25[0m: test/event_service_test.dart: EventService Subscribe receives initial connected event[0m                                                                                                       00:01 [32m+26[0m: test/ai_service_test.dart: AiCache clear should empty cache[0m                                                                                                                                 00:01 [32m+27[0m: test/ai_service_test.dart: AiCache clear should empty cache[0m                                                                                                                                 00:01 [32m+27[0m: test/ai_service_test.dart: AiService should enhance description using DeepSeek (OpenAI compatible)[0m                                                                                          00:01 [32m+28[0m: test/ai_service_test.dart: AiService should enhance description using DeepSeek (OpenAI compatible)[0m                                                                                          00:01 [32m+29[0m: test/ai_service_test.dart: AiService should enhance description using DeepSeek (OpenAI compatible)[0m                                                                                          00:01 [32m+30[0m: test/ai_service_test.dart: AiService should enhance description using DeepSeek (OpenAI compatible)[0m                                                                                          00:01 [32m+31[0m: test/ai_service_test.dart: AiService should enhance description using DeepSeek (OpenAI compatible)[0m                                                                                          00:01 [32m+31[0m: test/ai_service_test.dart: AiService should use cached response if available[0m                                                                                                                00:01 [32m+32[0m: test/ai_service_test.dart: AiService should use cached response if available[0m                                                                                                                00:01 [32m+32[0m: test/ai_service_test.dart: AiService should handle API errors gracefully[0m                                                                                                                    00:01 [32m+33[0m: test/ai_service_test.dart: AiService should handle API errors gracefully[0m                                                                                                                    00:01 [32m+33[0m: test/ai_service_test.dart: AiService should handle Anthropic format[0m                                                                                                                         00:01 [32m+34[0m: test/ai_service_test.dart: AiService should handle Anthropic format[0m                                                                                                                         00:01 [32m+34[0m: test/ai_service_test.dart: AiService should handle Google Gemini format[0m                                                                                                                     00:01 [32m+35[0m: test/ai_service_test.dart: AiService should handle Google Gemini format[0m                                                                                                                     00:01 [32m+35[0m: test/ai_service_test.dart: AiService should handle Cohere format[0m                                                                                                                            00:01 [32m+36[0m: test/ai_service_test.dart: AiService should handle Cohere format[0m                                                                                                                            00:01 [32m+36[0m: [1m[90mloading test/auth_service_test.dart[0m[0m                                                                                                                                                         00:01 [32m+36[0m: test/auth_service_test.dart: AuthService Update Settings - Missing Session - 403[0m                                                                                                            00:01 [32m+36[0m: test/auth_service_test.dart: AuthService Update Settings - Missing Session - 403[0m                                                                                                            
WARN: AUTH_JWT_SECRET not set. Using random secret for this session.
00:01 [32m+37[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+37[0m: test/auth_service_test.dart: AuthService Update Settings - With Session / No CSRF - 403[0m                                                                                                     
WARN: AUTH_JWT_SECRET not set. Using random secret for this session.
00:01 [32m+38[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+38[0m: test/auth_service_test.dart: AuthService Update Settings - With Session AND CSRF - 200[0m                                                                                                      
WARN: AUTH_JWT_SECRET not set. Using random secret for this session.
00:01 [32m+38[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+39[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+39[0m: test/auth_service_test.dart: AuthService Delete Account - CSRF Enforcement[0m                                                                                                                  
WARN: AUTH_JWT_SECRET not set. Using random secret for this session.
00:01 [32m+40[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+40[0m: test/auth_service_test.dart: AuthService Unlink Devices - CSRF Enforcement[0m                                                                                                                  
WARN: AUTH_JWT_SECRET not set. Using random secret for this session.
00:01 [32m+41[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+42[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+42[0m: test/mailer_service_test.dart: MailerService sendEmail returns false on error[0m                                                                                                               
Failed to send email: Exception: SMTP Error
00:01 [32m+43[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+44[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+44[0m: test/prefetch_service_test.dart: PrefetchService start warms cache immediately[0m                                                                                                              
PrefetchService: Starting background warmer...
PrefetchService: Warming cache...
PrefetchService: Warm complete.
00:01 [32m+44[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+45[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+45[0m: test/prefetch_service_test.dart: PrefetchService start schedules periodic updates[0m                                                                                                           
PrefetchService: Starting background warmer...
PrefetchService: Warming cache...
PrefetchService: Warm complete.
PrefetchService: Warming cache...
PrefetchService: Warm complete.
00:01 [32m+46[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+46[0m: test/prefetch_service_test.dart: PrefetchService stop cancels timer[0m                                                                                                                         
PrefetchService: Starting background warmer...
PrefetchService: Warming cache...
PrefetchService: Warm complete.
00:01 [32m+47[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+48[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+49[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+50[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+51[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+52[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                       00:01 [32m+52[0m[31m -1[0m: test/swarm_service_test.dart: SwarmService scrapeSwarm returns data on success [1m[31m[E][0m[0m                                                                                                       
  Expected: not null
    Actual: <null>
  
  package:matcher                    expect
  test/swarm_service_test.dart 59:7  main.<fn>.<fn>
  

[1m[36mTo run this test again:[0m /opt/homebrew/share/flutter/bin/cache/dart-sdk/bin/dart test test/swarm_service_test.dart -p vm --plain-name 'SwarmService scrapeSwarm returns data on success'
00:01 [32m+53[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+54[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+55[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+55[0m[31m -1[0m: test/p2p_node_test.dart: P2PNode start initializes and starts IPFS node[0m                                                                                                                  
P2P: Initializing SeedSphere Bootstrap Node...
P2P: ðŸ§¹ Removed stale DB lock file.
00:01 [32m+56[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+56[0m[31m -1[0m: test/p2p_node_test.dart: P2PNode start initializes and starts IPFS node[0m                                                                                                                  
P2P: Bootstrap Node Active
P2P: PeerID: QmPeerId123
P2P: Listening on: [/ip4/127.0.0.1/tcp/4001]
00:01 [32m+57[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+58[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+59[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+60[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+60[0m[31m -1[0m: test/p2p_node_test.dart: P2PNode start called twice does not restart[0m                                                                                                                     
P2P: Initializing SeedSphere Bootstrap Node...
P2P: Bootstrap Node Active
P2P: PeerID: Dummy_String_created_while_calling_peerId_on_MockIPFSNode.
P2P: Listening on: []
00:01 [32m+61[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+62[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+62[0m[31m -1[0m: test/p2p_node_test.dart: P2PNode stop stops the node[0m                                                                                                                                     
P2P: Initializing SeedSphere Bootstrap Node...
P2P: Bootstrap Node Active
P2P: PeerID: Dummy_String_created_while_calling_peerId_on_MockIPFSNode.
P2P: Listening on: []
00:01 [32m+63[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+64[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+65[0m[31m -1[0m: test/db_service_test.dart: DbService upsertGardener and touchGardener[0m                                                                                                                    00:01 [32m+66[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:01 [32m+67[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:01 [32m+68[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:01 [32m+69[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:01 [32m+70[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:01 [32m+71[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+71[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+72[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+73[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+74[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+75[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+76[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+77[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:02 [32m+78[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:03 [32m+78[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:04 [32m+78[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:05 [32m+78[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:06 [32m+78[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encrypt and Decrypt - Success[0m                                                                                                                 00:06 [32m+79[0m[31m -1[0m: test/server_test.dart: Portal (Root)[0m                                                                                                                                                     00:07 [32m+79[0m[31m -1[0m: test/server_test.dart: Portal (Root)[0m                                                                                                                                                     00:08 [32m+79[0m[31m -1[0m: test/server_test.dart: Portal (Root)[0m                                                                                                                                                     00:09 [32m+79[0m[31m -1[0m: test/server_test.dart: Portal (Root)[0m                                                                                                                                                     00:09 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:10 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:11 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:12 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:13 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:14 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:15 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:16 [32m+80[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:16 [32m+81[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:17 [32m+81[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Encryption should use random salts (Probabilistic)[0m                                                                                            00:17 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:18 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:19 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:20 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:21 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:22 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:23 [32m+82[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:23 [32m+82[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Decrypt with wrong key fails[0m                                                                                                                  
Decryption error: Instance of 'InvalidCipherTextException'
00:23 [32m+83[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:23 [32m+83[0m[31m -1[0m: test/crypto_helper_test.dart: CryptoHelper Decrypt garbage fails[0m                                                                                                                         
Decryption error: Exception: Invalid ciphertext length
00:23 [32m+84[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:23 [32m+85[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:23 [32m+86[0m[31m -1[0m: test/server_test.dart: 404[0m                                                                                                                                                               00:23 [32m+86[0m[31m -1[0m: [31mSome tests failed.[0m                                                                                                                                                                       

Consider enabling the flag chain-stack-traces to receive more detailed exceptions.
For example, 'dart test --chain-stack-traces'.
